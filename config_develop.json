{
  "mode": "develop",
  "description": "å¼€å‘æ¨¡å¼ - ç”¨äºå¼€å‘å’Œè°ƒè¯•ï¼Œä¸åŠ å¯†",
  "serial_port": "/dev/cu.wchusbserial210",
  "chip_type": "esp32c2",
  "firmware_path": "firmware/CO2ControllerFW_combined_0_3_12.bin",
  "flash_mode": "dio",
  "flash_freq": "60m",
  "flash_size": "2MB",
  "erase_flash": false,
  "partition_table": null,
  "bootloader": null,
  "app_offset": "0x10000",
  "verify": true,
  "reset_after_flash": false,
  "encrypt": false,
  "secure_boot": false,
  "version_string": "P02V02R00",
  "mode_number": "20065",
  "batch": "SN: YYMMDD+åºå·",
  "print_device_logs": false,
  "hash_verification_timeout": 20,
  "filter_serial_ports": true,
  "serial_port_keywords": [
    "USB Serial",
    "Serial",
    "COM",
    "USB"
  ],
  "exclude_port_patterns": [
    "debug-console",
    "wlan-debug",
    "Bluetooth",
    "HUAWEI",
    "n/a"
  ],
  "baud_rate": 2000000,
  "monitor_baud": 78400,
  "procedures": [
    {
      "name": "development_mode_procedure",
      "description": "å¼€å‘æ¨¡å¼æµç¨‹ - ç”¨äºå¼€å‘å’Œè°ƒè¯•ï¼Œä»…åŒ…å«çƒ§å½•æ­¥éª¤",
      "steps": [
        {
          "name": "check_uart",
          "type": "check_uart",
          "description": "ç¯å¢ƒç¡®è®¤ - æ£€æŸ¥UARTä¸²å£æ˜¯å¦å­˜åœ¨",
          "timeout": 5,
          "on_failure": "error"
        },
        {
          "name": "flash_firmware",
          "type": "flash_firmware",
          "description": "æ‰§è¡Œå›ºä»¶çƒ§å½•ï¼Œçƒ§å½•æˆåŠŸåä¿æŒbootloaderçŠ¶æ€",
          "timeout": 60,
          "on_failure": "error"
        }
      ]
    },
    {
      "name": "development_test_procedure",
      "description": "å¼€å‘æ¨¡å¼æµ‹è¯•æµç¨‹ - çƒ§å½•åè‡ªæ£€ï¼ˆRTCã€å‹åŠ›ã€æŒ‰é’®ã€ç‰ˆæœ¬/åºåˆ—å·ç­‰ï¼‰",
      "steps": [
        {
          "name": "test_after_flash_procedure",
          "type": "self_test",
          "description": "çƒ§å½•åæµ‹è¯•æµç¨‹",
          "steps": [
            {
              "name": "get_esp_info",
              "type": "get_esp_info",
              "description": "é€šè¿‡esptoolè·å–ESPä¿¡æ¯ï¼ˆMACåœ°å€ï¼‰",
              "timeout": 10,
              "on_failure": "warning"
            },
            {
              "name": "reset_and_monitor",
              "type": "reset_and_monitor",
              "description": "å¤ä½è®¾å¤‡å¹¶ç›‘æ§æ—¥å¿—ï¼Œæ£€æµ‹å¤ä½æˆåŠŸæ ‡å¿—ï¼Œå¹¶åœ¨æ•´ä¸ªè‡ªæ£€è¿‡ç¨‹ä¸­æŒç»­è§£ææ—¥å¿—ï¼ˆFactory Modeã€RTCã€å‹åŠ›ä¼ æ„Ÿå™¨ã€æŒ‰é’®æç¤ºã€ç¡¬ä»¶ç‰ˆæœ¬/åºåˆ—å·æç¤ºç­‰ï¼‰",
              "timeout": 60,
              "reset_detection_timeout": 5.0,
              "log_patterns": {
                "reset_success": [
                  "rst:0x1",
                  "POWERON",
                  "boot:0xe",
                  "SPI_FAST_FLASH_BOOT"
                ],
                "factory_config_mode": [
                  "Factory Configuration Mode",
                  "factory_config:"
                ],
                "rtc_pass": [
                  "Time passed",
                  "RTC Time now:"
                ],
                "rtc_time_set_success": [
                  "RTC time set to:",
                  "RTC time set to",
                  "rtc time set to"
                ],
                "pressure_sensor_pass": [
                  "Pressure Sensor Calibration Value Ok",
                  "Pressure Sensor Reading:"
                ],
                "button_prompt": [
                  "Press button to continue",
                  "button to continue",
                  "Press button if",
                  "Press button"
                ],
                "button_clicked": [
                  "Button clicked",
                  "button clicked",
                  "Button Clicked"
                ],
                "rtc_time_prompt": [
                  "Enter current date and time",
                  "Enter current date and time (YYYY-MM-DDTHH:MM:SS):",
                  "Enter date and time",
                  "date and time"
                ],
                "press_enter_to_continue": [
                  "Press ENTER to continue",
                  "Press ENTER to continue...",
                  "Press Enter to continue",
                  "Press Enter to continue..."
                ],
                "hardware_version_prompt": [
                  "Enter Hardware Version:",
                  "Enter hardware version:",
                  "Hardware Version:"
                ],
                "hardware_version_success": [
                  "Received Hardware Version",
                  "Hardware Version received",
                  "Hardware version accepted"
                ],
                "hardware_version_error": [
                  "wrong format",
                  "try again",
                  "format error",
                  "invalid format"
                ],
                "serial_number_prompt": [
                  "Enter Serial Number:",
                  "Enter serial number:",
                  "Serial Number:",
                  "Enter Device Code:",
                  "Enter device code:"
                ],
                "model_number_prompt": [
                  "Enter Model Number",
                  "Enter model number",
                  "Model Number:",
                  "Enter Device Number",
                  "Enter device number"
                ],
                "model_number_success": [
                  "Received Model Number",
                  "Model Number received",
                  "Model number accepted"
                ],
                "serial_number_success": [
                  "Received Serial Number",
                  "Serial Number received",
                  "Serial number accepted"
                ],
                "factory_config_complete": [
                  "Factory Configuration Complete",
                  "Factory configuration complete",
                  "Configuration Complete"
                ]
              },
              "extract_mac": true,
              "extract_pressure": true,
              "extract_rtc": true,
              "monitor_button": true,
              "test_states": {
                "application_mode": {
                  "patterns": [
                    "Device already setup",
                    "skipping factory configuration",
                    "already setup, skipping factory"
                  ],
                  "message": "âš ï¸  è¯¥è®¾å¤‡å·²è¿›å…¥ application modeï¼Œæ— æ³•å†æ¬¡å¯åŠ¨æµ‹è¯•",
                  "action": "reject"
                },
                "factory_config_mode": {
                  "patterns": [
                    "Factory Configuration Mode",
                    "factory_config:"
                  ],
                  "message": "ğŸ“‹ è¿›å…¥å·¥å‚é…ç½®æ¨¡å¼",
                  "timeout": 2
                },
                "rtc_test": {
                  "patterns": [
                    "Time passed",
                    "RTC Time now:"
                  ],
                  "message": "â±ï¸  RTCæµ‹è¯•é€šè¿‡"
                },
                "pressure_sensor_test": {
                  "patterns": [
                    "Pressure Sensor Calibration Value Ok",
                    "Pressure Sensor Reading:"
                  ],
                  "message": "ğŸ“Š å‹åŠ›ä¼ æ„Ÿå™¨æµ‹è¯•é€šè¿‡"
                },
                "waiting_button": {
                  "patterns": [
                    "Press button to continue",
                    "button to continue"
                  ],
                  "message": "ğŸ”˜ ç­‰å¾…ç”¨æˆ·æŒ‰ä¸‹æŒ‰é”®ï¼ˆ10s å†…æ£€æµ‹åˆ°æŒ‰é”®åŠ¨ä½œè§†ä¸ºé€šè¿‡ï¼‰"
                }
              },
              "auto_advance_on": {
                "pattern": "Enter Hardware Version:",
                "description": "æ£€æµ‹åˆ°ç¡¬ä»¶ç‰ˆæœ¬è¾“å…¥æç¤ºï¼Œè‡ªåŠ¨è¿›å…¥ä¸‹ä¸€æ­¥",
                "wait_for_button": true,
                "button_prompt": "Press button to continue"
              },
              "on_failure": "warning"
            },
            {
              "name": "wait_for_factory_config",
              "type": "wait_for_prompt",
              "description": "ç›‘å¬æ˜¯å¦è¿›å…¥Factory Configuration Modeï¼Œè¶…æ—¶æ—¶é—´2ç§’",
              "prompt_pattern": "Factory Configuration Mode",
              "timeout": 2,
              "on_failure": "warning"
            },
            {
              "name": "wait_for_rtc_pass",
              "type": "wait_for_prompt",
              "description": "ç›‘å¬RTCäº‹ä»¶ï¼Œå¦‚æœæ”¶åˆ°Time passedï¼Œåˆ™è¡¨ç¤ºRTCé€šè¿‡",
              "prompt_pattern": "Time passed",
              "timeout": 10,
              "on_failure": "warning"
            },
            {
              "name": "wait_for_pressure_sensor_pass",
              "type": "wait_for_prompt",
              "description": "ç›‘å¬å‹åŠ›ä¼ æ„Ÿå™¨äº‹ä»¶ï¼Œå¦‚æœæ”¶åˆ°Pressure Sensor Calibration Value Okï¼Œåˆ™è¡¨ç¤ºå‹åŠ›ä¼ æ„Ÿå™¨é€šè¿‡",
              "prompt_pattern": "Pressure Sensor Calibration Value Ok",
              "timeout": 10,
              "on_failure": "warning"
            },
            {
              "name": "wait_for_button_prompt",
              "type": "wait_for_prompt",
              "description": "ç›‘å¬Press button to continueï¼Œæç¤ºç”¨æˆ·æŒ‰ä¸‹æŒ‰é”®",
              "prompt_pattern": "Press button to continue",
              "timeout": 30,
              "on_failure": "warning"
            },
            {
              "name": "wait_for_rtc_time_prompt",
              "type": "wait_for_prompt",
              "description": "ç­‰å¾…æ—¥æœŸæ—¶é—´è¾“å…¥æç¤º",
              "prompt_pattern": "Enter current date and time",
              "timeout": 5,
              "skip_if_detected": false,
              "on_failure": "warning"
            },
            {
              "name": "input_rtc_time",
              "type": "interactive_input",
              "description": "è¾“å…¥å½“å‰æ—¥æœŸæ—¶é—´ï¼ˆæ ¼å¼ï¼šYYYY-MM-DDTHH:MM:SSï¼‰ï¼Œè‡ªåŠ¨ä½¿ç”¨ç³»ç»Ÿæ—¶é—´",
              "prompt": "è¯·è¾“å…¥å½“å‰æ—¥æœŸæ—¶é—´ï¼ˆæ ¼å¼ï¼šYYYY-MM-DDTHH:MM:SSï¼Œç•™ç©ºåˆ™ä½¿ç”¨å½“å‰ç³»ç»Ÿæ—¶é—´ï¼‰:",
              "fallback_to_config": false,
              "auto_generate": true,
              "auto_generate_type": "current_time",
              "send_to_device": true,
              "on_failure": "error"
            },
            {
              "name": "wait_for_rtc_time_set_success",
              "type": "wait_for_prompt",
              "description": "ç­‰å¾…RTCæ—¶é—´å†™å…¥æˆåŠŸç¡®è®¤ï¼ˆæ£€æµ‹åˆ° RTC time set to è¡¨ç¤ºå†™å…¥æˆåŠŸï¼‰",
              "prompt_pattern": "RTC time set to:",
              "timeout": 5,
              "skip_if_detected": false,
              "on_failure": "warning"
            },
            {
              "name": "wait_for_model_number_prompt",
              "type": "wait_for_prompt",
              "description": "ç­‰å¾…å‹å·è¾“å…¥æç¤ºï¼ˆå¦‚æœä¸Šä¸€æ­¥å·²æ£€æµ‹åˆ°ï¼Œå°†è‡ªåŠ¨è·³è¿‡ï¼‰",
              "prompt_pattern": "Enter Model Number:",
              "timeout": 5,
              "skip_if_detected": true,
              "on_failure": "warning"
            },
            {
              "name": "input_model_number",
              "type": "interactive_input",
              "description": "å¦‚æœéœ€è¦è¾“å…¥å‹å·ï¼Œåˆ™è‡ªåŠ¨è¾“å…¥ï¼ˆä»é…ç½®æ–‡ä»¶è¯»å–ï¼‰",
              "prompt": "è¯·è¾“å…¥å‹å·ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„mode_numberï¼‰:",
              "fallback_to_config": true,
              "config_key": "mode_number",
              "config_files": [
                "config_develop.json",
                "config.json"
              ],
              "send_to_device": true,
              "on_failure": "error"
            },
            {
              "name": "wait_for_hardware_version_prompt",
              "type": "wait_for_prompt",
              "description": "ç­‰å¾…ç¡¬ä»¶ç‰ˆæœ¬è¾“å…¥æç¤ºï¼ˆå¦‚æœä¸Šä¸€æ­¥å·²æ£€æµ‹åˆ°ï¼Œå°†è‡ªåŠ¨è·³è¿‡ï¼‰",
              "prompt_pattern": "Enter Hardware Version:",
              "timeout": 5,
              "skip_if_detected": true,
              "on_failure": "warning"
            },
            {
              "name": "input_hardware_version",
              "type": "interactive_input",
              "description": "å¦‚æœéœ€è¦è¾“å…¥ç¡¬ä»¶ç‰ˆæœ¬ï¼Œåˆ™è‡ªåŠ¨è¾“å…¥ï¼ˆä»é…ç½®æ–‡ä»¶è¯»å–ï¼‰",
              "prompt": "è¯·è¾“å…¥ç¡¬ä»¶ç‰ˆæœ¬ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„version_stringï¼‰:",
              "fallback_to_config": true,
              "config_key": "version_string",
              "config_files": [
                "config_develop.json",
                "config.json"
              ],
              "send_to_device": true,
              "on_failure": "error"
            },
            {
              "name": "wait_for_serial_number_prompt",
              "type": "wait_for_prompt",
              "description": "ç­‰å¾…åºåˆ—å·è¾“å…¥æç¤º",
              "prompt_pattern": "Enter Serial Number:",
              "timeout": 5,
              "skip_if_detected": false,
              "on_failure": "warning"
            },
            {
              "name": "input_serial_number",
              "type": "interactive_input",
              "description": "å¦‚æœéœ€è¦è¾“å…¥åºåˆ—å·ï¼Œåˆ™è‡ªåŠ¨è¾“å…¥ï¼ˆå¦‚æœé…ç½®äº†device_code_ruleåˆ™è‡ªåŠ¨ç”Ÿæˆï¼Œå¦åˆ™æç¤ºç”¨æˆ·è¾“å…¥ï¼‰",
              "prompt": "è¯·è¾“å…¥åºåˆ—å·ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨device_code_ruleè‡ªåŠ¨ç”Ÿæˆ):",
              "fallback_to_config": false,
              "send_to_device": true,
              "on_failure": "warning"
            },
            {
              "name": "wait_for_enter_to_continue",
              "type": "wait_for_prompt",
              "description": "ç­‰å¾… Press ENTER to continue æç¤º",
              "prompt_pattern": "Press ENTER to continue",
              "timeout": 5,
              "skip_if_detected": false,
              "on_failure": "warning"
            },
            {
              "name": "send_enter_to_continue",
              "type": "interactive_input",
              "description": "è‡ªåŠ¨å‘é€æ¢è¡Œç¬¦ç»§ç»­",
              "prompt": "",
              "auto_send": true,
              "send_value": "",
              "send_to_device": true,
              "on_failure": "warning"
            }
          ],
          "on_failure": "warning"
        }
      ]
    }
  ],
  "device_code_rule": "64YYWWXnnnnn",
  "print_esptool_logs": false,
  "print_debug_logs": false
}